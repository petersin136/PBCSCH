# ì¤‘ê³ ë“±ë¶€ ì›¹ì‚¬ì´íŠ¸ â€“ ê´€ë¦¬ì í˜ì´ì§€ ê·¸ëŒ€ë¡œ ë³µì‚¬ìš© í”„ë¡¬í”„íŠ¸

---

## âœ… í•  ì¼ ìˆœì„œ (ì´ê²ƒë§Œ ë³´ë©´ ë¨)

### ê²½ìš° 1: ì¤‘ê³ ë“±ë¶€ **ìƒˆ ì›¹ì‚¬ì´íŠ¸ í”„ë¡œì íŠ¸**ë¥¼ ë§Œë“œëŠ” ê²½ìš°

**í•œ ê°€ì§€ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.**

1. ì´ ë¬¸ì„œì—ì„œ **ì•„ë˜ "â‘  í”„ë¡¬í”„íŠ¸"** ë¶€ë¶„ ì „ì²´ë¥¼ ë³µì‚¬í•œë‹¤. (``` ë¶€í„° ``` ê¹Œì§€ ì „ë¶€)
2. **ì¤‘ê³ ë“±ë¶€ ìƒˆ í”„ë¡œì íŠ¸**ë¥¼ ì—° Cursor ì±„íŒ…ì— **í•œ ë²ˆë§Œ** ë¶™ì—¬ë„£ê³  ì „ì†¡í•œë‹¤.
3. ë. (Cursorê°€ Next.js + API + ê´€ë¦¬ì HTML í˜ì´ì§€ê¹Œì§€ ë§Œë“¤ì–´ ì¤€ë‹¤.)

â†’ **ì£¼ì¼í•™êµ-í•™ìƒê´€ë¦¬-ë…ë¦½ë³¸.html ì€ ì´ ê²½ìš°ì— ì“°ì§€ ì•ŠìŠµë‹ˆë‹¤.** ìƒˆ í”„ë¡œì íŠ¸ì—ì„œëŠ” í”„ë¡¬í”„íŠ¸ë§Œ ì£¼ë©´ ë¨.

---

### ê²½ìš° 2: ì´ë¯¸ ìˆëŠ” **ë‹¤ë¥¸ ì›¹ì‚¬ì´íŠ¸**ì— ê´€ë¦¬ì í˜ì´ì§€ë§Œ ë„£ëŠ” ê²½ìš°

1. **ì£¼ì¼í•™êµ-í•™ìƒê´€ë¦¬-ë…ë¦½ë³¸.html** íŒŒì¼ ì „ì²´ë¥¼ ë³µì‚¬í•´ì„œ ê·¸ ì‚¬ì´íŠ¸ì— ë¶™ì—¬ë„£ê¸°(ë˜ëŠ” ì—…ë¡œë“œ).
2. ê·¸ ì‚¬ì´íŠ¸ê°€ **ë°ì´í„° API**(/api/students, /api/attendance, /api/notes)ë¥¼ ì œê³µí•˜ëŠ” ì£¼ì†Œê°€ ë”°ë¡œ ìˆìœ¼ë©´, HTML ì•ˆì˜ `API_BASE_OVERRIDE`ë¥¼ ê·¸ ì£¼ì†Œë¡œ ìˆ˜ì •.
3. ë. (ìì„¸í•œ ê±´ `ë…ë¦½ë³¸-ì‚¬ìš©ë²•.txt` ì°¸ê³ .)

---

## â‘  í”„ë¡¬í”„íŠ¸ (ì¤‘ê³ ë“±ë¶€ ìƒˆ í”„ë¡œì íŠ¸ì¼ ë•Œ ì´ê²ƒë§Œ ë³µì‚¬ â†’ Cursorì— ë¶™ì—¬ë„£ê¸°)

```
ìš°ë¦¬ ì¤‘ê³ ë“±ë¶€ ì „ìš© ì›¹ì‚¬ì´íŠ¸ë¥¼ ë§Œë“¤ì–´ì¤˜. ê¸°ìˆ  ìŠ¤íƒì€ Next.js(App Router) + TypeScript + Tailwind + Supabase(JS SDK)ë¡œ í•´ì¤˜.

ã€ ìš”ì²­ ã€‘
- ë©”ì¸ì€ ì‹¬í”Œí•œ ì¤‘ê³ ë“±ë¶€ ì†Œê°œ/ëœë”© í˜ì´ì§€ë§Œ ìˆì–´ë„ ë˜ê³ ,
- **ê´€ë¦¬ì í˜ì´ì§€(/manage)ëŠ” â€œì£¼ì¼í•™êµ í•™ìƒê´€ë¦¬â€ì²˜ëŸ¼ ì¶œê²°Â·í•™ìƒê´€ë¦¬ ê¸°ëŠ¥ì„ ë˜‘ê°™ì´ êµ¬í˜„í•´ì¤˜.â€
- ì¦‰, ê´€ë¦¬ì ë¡œê·¸ì¸ â†’ í•™ìƒ ëª©ë¡Â·52ì£¼ ì¶œì„ë¶€Â·ì£¼ê°„ ë…¸íŠ¸Â·ì—‘ì…€ ë‚´ë³´ë‚´ê¸°(í•©ê³„ í¬í•¨)ê¹Œì§€ ì „ë¶€ ë™ì¼í•˜ê²Œ.

ã€ ê´€ë¦¬ì í˜ì´ì§€ ë™ì‘ (ê·¸ëŒ€ë¡œ ë”°ë¼ í•´ì¤˜) ã€‘
1. /manage ì ‘ì† ì‹œ ë¡œê·¸ì¸ í™”ë©´ (ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸). ë¡œê·¸ì¸ ì„±ê³µ ì‹œ sessionStorageì— ì¸ì¦ ì €ì¥.
2. ì¸ì¦ í›„ ìƒë‹¨ì— â€œê°¤ëŸ¬ë¦¬ ì„ë² ë“œ ê´€ë¦¬â€(/manage/gallery), â€œë©”ì¸ í™ˆâ€(/) ë§í¬ ìˆëŠ” ë„¤ë¹„, ê·¸ ì•„ë˜ iframeìœ¼ë¡œ í•™ìƒê´€ë¦¬ í˜ì´ì§€ ë¡œë“œ.
3. iframe ì•ˆì—ëŠ” **ë‹¨ì¼ HTML í˜ì´ì§€**ë¡œ ë‹¤ìŒ ê¸°ëŠ¥ì´ ë“¤ì–´ê°€ ìˆì–´ì•¼ í•¨:
   - í•™ë…„ íƒ­: ì „ì²´, 1í•™ë…„~6í•™ë…„ (ì¤‘ê³ ë“±ë¶€ë©´ 1í•™ë…„~3í•™ë…„ ë˜ëŠ” â€œì¤‘1Â·ì¤‘2Â·ì¤‘3Â·ê³ 1Â·ê³ 2Â·ê³ 3â€ ë“±ìœ¼ë¡œ ì´ë¦„ë§Œ ë°”ê¿”ë„ ë¨)
   - í†µê³„ ì¹´ë“œ: ìƒˆì¹œêµ¬, ì •ì°©, ê°„í—, ìœ„í—˜, íœ´ë©´ ì¸ì›
   - ì„ íƒ í•™ë…„ ë‹´ì„ í•œ ì¤„ í‘œì‹œ (ì „ì²´ì¼ ë•ŒëŠ” ë‹´ë‹¹ ì „ë„ì‚¬ë§Œ)
   - ê²€ìƒ‰(ì´ë¦„, ë‹´ë‹¹êµì‚¬) + ìƒíƒœ í•„í„°(ì „ì²´/ìƒˆì¹œêµ¬/ì •ì°©/ê°„í—/ìœ„í—˜/íœ´ë©´)
   - í•™ìƒ ëª©ë¡ í…Œì´ë¸”: ì‚¬ì§„Â·ì´ë¦„Â·ì—°ë½ì²˜(í´ë¦­ ì‹œ ì£¼ê°„ ê¸°ë¡ ëª¨ë‹¬), í•™ë…„, ìƒíƒœ, ì¶œì„, ê²°ì„ì£¼, ë‹´ë‹¹, ë™ì˜ì„œ, ê¸°ë„, ì•¡ì…˜(ìˆ˜ì •/ì „í™”/ì‚­ì œ)
   - 52ì£¼ ì¶œì„ë¶€: ì—°ë„ ì„ íƒ, ì›” íƒ­, ì£¼ì°¨ pills, â€œí˜„ì¬ â—‹ì›” â—‹ì§¸ ì£¼ (â—‹ì›” â—‹ì¼ ì£¼ì¼)â€ í‘œì‹œ, í•™ë…„ë³„ ì¶œì„ ì²´í¬(ì¶œì„/ì§€ê°/ê²°ì„), í•™ë…„ë³„Â·ì „ì²´ ì†Œê³„
   - ì—´ ë•Œë§ˆë‹¤ **ì˜¤ëŠ˜ í¬í•¨ ì£¼ì˜ ì£¼ì¼**ì´ ì„ íƒëœ ìƒíƒœë¡œ ë³´ì´ê²Œ
   - ì—‘ì…€: ì „ì²´ ëª…ë‹¨(í•©ê³„: ì „ì²´ ì¸ì›, í•™ë…„ë³„, ìƒíƒœë³„, ë™ì˜ì„œ) + ì¶œì„ë¶€(í˜„ì¬ ì£¼ / ì—°Â·ì›”Â·ì£¼ ì„ íƒ, í•©ê³„ í¬í•¨)
   - í•™ìƒ ë“±ë¡/ìˆ˜ì • ëª¨ë‹¬: ì‚¬ì§„, ì´ë¦„, í•™ë…„, ë³´í˜¸ì/í•™ìƒ ì—°ë½ì²˜, ì²«ë°©ë¬¸ì¼, ìƒíƒœ, ì†Œê·¸ë£¹/ë‹´ë‹¹êµì‚¬, ê¸°ë„ì œëª©, í•™ë¶€ëª¨ ë™ì˜ì„œ(ì²´í¬+ì‚¬ì§„), ì¼€ì–´ ì •ë³´(ìµœê·¼ ì¶œì„ì¼, ê²°ì„ ì£¼, ë§ˆì§€ë§‰ ì—°ë½ì¼, ì—°ë½ë°©ë²•), ì´íƒˆ ì´ìœ  ì²´í¬, ë©”ëª¨
   - ì£¼ê°„ ê¸°ë¡ ëª¨ë‹¬: ì‚¬ì§„Â·ì´ë¦„Â·ì—°ë½ì²˜ í´ë¦­ ì‹œ ì—´ë¦¼, ì—°Â·ì›” ì„ íƒ(â—€ â–¶) + ì£¼ì°¨ ì„ íƒ, í•´ë‹¹ ì£¼ ë©”ëª¨Â·ê¸°ë„ì œëª© ì €ì¥, ì „í™”ê±¸ê¸° ë²„íŠ¼
   - ì „í™” ê±¸ê¸°: ğŸ“ ë²„íŠ¼ì€ tel: ë§í¬ë¡œ ì‹¤ì œ í†µí™”

ã€ API (Next.js API Routes) ã€‘
- GET/POST/PATCH/DELETE /api/students  â†’ Supabase `students` í…Œì´ë¸” (camelCase â†” snake_case ë³€í™˜)
- GET/POST /api/attendance  â†’ body: { key, status }, ì‘ë‹µ: GET ì‹œ { records: { [key]: status } }
- GET /api/notes?student_id=  â†’ í•´ë‹¹ í•™ìƒ ì£¼ê°„ ë…¸íŠ¸ ëª©ë¡
- POST /api/notes  â†’ body: { student_id, year, month, week, note, prayer }

ã€ Supabase í…Œì´ë¸” ã€‘
- students: id, name, grade, parent_contact, student_contact, first_visit, status, last_attend, absence_weeks, owner, last_contact, contact_method, reasons(json), memo, consent_checked, consent_image, profile_image, prayer (track ì»¬ëŸ¼ ìˆìœ¼ë©´ ë¬´ì‹œí•´ë„ ë¨)
- attendance: key(ë¬¸ìì—´, ì˜ˆ: "2026-2-2-12345"), status("present"|"late"|"absent")
- student_notes: student_id, year, month, week, note, prayer (upsert ì‹œ year+month+week+student_id ê¸°ì¤€)

ã€ í™˜ê²½ ë³€ìˆ˜ ã€‘
- NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY (ë˜ëŠ” SUPABASE_URL, SUPABASE_ANON_KEY)
- API ë¼ìš°íŠ¸ì—ì„œëŠ” ë‘˜ ë‹¤ ì§€ì›í•˜ë„ë¡: process.env.NEXT_PUBLIC_SUPABASE_URL || process.env.SUPABASE_URL

ã€ ê´€ë¦¬ì í˜ì´ì§€ íŒŒì¼ êµ¬ì¡° (ì°¸ê³ ) ã€‘
- app/manage/page.tsx  â†’ ë¡œê·¸ì¸ + iframe src="/manage/student-management-v3.html"
- public/manage/student-management-v3.html  â†’ ìœ„ì— ì ì€ ê¸°ëŠ¥ì´ ë‹¤ ë“¤ì–´ ìˆëŠ” ë‹¨ì¼ HTML (ìŠ¤íƒ€ì¼Â·ìŠ¤í¬ë¦½íŠ¸ ì¸ë¼ì¸)
- app/api/students/route.ts
- app/api/attendance/route.ts
- app/api/notes/route.ts

ì§€ê¸ˆ ìš°ë¦¬ê°€ ì“°ëŠ” í”„ë¡œì íŠ¸(PBCSCH)ì˜ ì´ ê´€ë¦¬ì í˜ì´ì§€ì™€ **ë™ì‘Â·UIÂ·APIÂ·DB êµ¬ì¡°ë¥¼ ë˜‘ê°™ì´** ë§Œë“¤ì–´ë‹¬ë¼. ì œëª©/ë¡œê³ ë§Œ â€œì¤‘ê³ ë“±ë¶€â€ë¡œ ë°”ê¿”ë„ ë˜ê³ , í•™ë…„ êµ¬ë¶„ì´ ì¤‘1~ê³ 3ì´ë©´ íƒ­ ì´ë¦„ë§Œ ê·¸ì— ë§ê²Œ ë°”ê¿”ì¤˜. ê¸°ëŠ¥ì€ ê·¸ëŒ€ë¡œ ë³µì‚¬í•´ì„œ êµ¬í˜„í•´ì¤˜.
```

---

## ğŸ“ ì°¸ê³ : Cursor ëŒ€ì‹  íŒŒì¼ë§Œ ì§ì ‘ ë³µì‚¬í•  ë•Œ

Cursorì— í”„ë¡¬í”„íŠ¸ ì£¼ëŠ” ëŒ€ì‹ , **íŒŒì¼ë§Œ** ê·¸ëŒ€ë¡œ ê°€ì ¸ê°€ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ ê²½ë¡œì—ì„œ ë³µì‚¬í•˜ë©´ ë©ë‹ˆë‹¤.

| ìš©ë„ | ê²½ë¡œ |
|------|------|
| ê´€ë¦¬ì ë¡œê·¸ì¸ + iframe | `app/manage/page.tsx` |
| í•™ìƒê´€ë¦¬ ë‹¨ì¼ HTML | `public/manage/student-management-v3.html` |
| í•™ìƒ API | `app/api/students/route.ts` |
| ì¶œì„ API | `app/api/attendance/route.ts` |
| ì£¼ê°„ ë…¸íŠ¸ API | `app/api/notes/route.ts` |

- Supabaseì— `students`, `attendance`, `student_notes` í…Œì´ë¸” ë§Œë“¤ê³ , `.env`ì— Supabase URL/ANON KEY ë„£ê¸°.
- ë¡œê·¸ì¸ì€ `app/manage/page.tsx` ì•ˆì˜ `ADMIN_ID`, `ADMIN_PW` ìˆ˜ì •.
- â€œì£¼ì¼í•™êµâ€ â†’ â€œì¤‘ê³ ë“±ë¶€â€ ë“± ë¬¸êµ¬ë§Œ ë°”ê¾¸ë©´ ë¨.

---

## Supabase í…Œì´ë¸” ìƒì„± SQL (ì°¸ê³ )

Supabase SQL Editorì—ì„œ ì•„ë˜ë¥¼ ì‹¤í–‰í•˜ë©´ í…Œì´ë¸”ì´ ìƒì„±ë©ë‹ˆë‹¤. (í•„ìš” ì‹œ RLS ì •ì±…ì€ Supabase ëŒ€ì‹œë³´ë“œì—ì„œ ì¶”ê°€.)

```sql
-- students
create table if not exists public.students (
  id bigint primary key,
  name text not null,
  grade text not null,
  parent_contact text default '',
  student_contact text default '',
  first_visit text default '',
  status text default 'ìƒˆì¹œêµ¬',
  last_attend text default '',
  absence_weeks int default 0,
  owner text default '',
  last_contact text default '',
  contact_method text default '',
  reasons jsonb default '[]',
  memo text default '',
  consent_checked boolean default false,
  consent_image text,
  profile_image text,
  prayer text default ''
);

-- attendance (key = "ë…„-ì›”-ì£¼ì°¨-í•™ìƒid", status = present | late | absent)
create table if not exists public.attendance (
  key text primary key,
  status text not null
);

-- student_notes (ì£¼ê°„ ê¸°ë¡)
create table if not exists public.student_notes (
  id bigserial primary key,
  student_id bigint not null,
  year int not null,
  month int not null,
  week int not null,
  note text default '',
  prayer text default '',
  unique(student_id, year, month, week)
);
```
